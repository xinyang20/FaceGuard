# Web 人脸门禁系统

一个基于 Web 的轻量级人脸识别门禁系统,使用深度学习模型实现高效的人脸检测与识别功能。

## 📋 项目简介

本系统是一个模拟人脸门禁系统,支持实时摄像头监控和静态图片识别。系统采用轻量级深度学习模型,即使在无硬件加速的环境下也能保持良好的性能表现。

**核心特性:**

- **实时监控**: 支持网页摄像头实时抓取画面进行人脸识别
- **图片识别**: 支持上传静态图片进行单次识别测试
- **人员管理**: 完善的人员录入、查看、删除功能
- **通行日志**: 详细记录所有识别记录,包括时间、状态、抓拍图
- **动态配置**: 支持实时调整识别参数(如抽帧间隔)
- **轻量高效**: 使用轻量级模型,快速响应

## 🛠 技术栈

### 前端
- Vue 3 - 渐进式 JavaScript 框架
- Vite - 新一代前端构建工具
- Element Plus - UI 组件库
- Axios - HTTP 客户端

### 后端
- FastAPI - 现代高性能 Python Web 框架
- SQLite - 轻量级数据库
- SQLAlchemy - ORM 框架

### AI 模型
- **人脸检测**: ULFD (Ultra-Light-Fast-Generic-Face-Detector-1MB)
- **特征提取**: EdgeFace-XS / ArcFace
- **相似度计算**: 余弦相似度

## 项目结构

```
renlianshibie/
├── backend/              # 后端服务
│   ├── app.py           # FastAPI 入口
│   ├── database.py      # 数据库模型定义
│   ├── core/            # 核心逻辑
│   │   ├── face_engine.py        # AI 推理引擎
│   │   └── config_manager.py     # 配置管理
│   ├── routes/          # API 路由
│   ├── models/          # AI 模型文件 (不包含在仓库中)
│   ├── static/          # 静态文件存储 (不包含在仓库中)
│   │   ├── avatars/     # 用户头像
│   │   └── logs/        # 抓拍图
│   └── logs/            # 系统日志 (不包含在仓库中)
├── frontend/            # 前端应用
│   ├── src/
│   │   ├── components/  # Vue 组件
│   │   ├── views/       # 页面视图
│   │   └── api/         # API 封装
│   └── public/          # 公共资源
└── README.md
```

## 快速开始

### 环境要求

- Python 3.8+
- Node.js 16+
- 现代浏览器 (Chrome/Firefox/Edge 等,需支持摄像头访问)

### 后端启动

```bash
# 进入后端目录
cd backend

# 使用 uv 安装依赖 (推荐)
uv sync

# 或使用 pip
pip install -r requirements.txt

# 启动后端服务
uvicorn app:app --reload --host 0.0.0.0 --port 8000
```

### 前端启动

```bash
# 进入前端目录
cd frontend

# 安装依赖
pnpm install
# 或使用 npm install

# 启动开发服务器
pnpm dev
# 或使用 npm run dev
```

访问 `http://localhost:5173` 即可使用系统。

## 功能说明

### 1. 门禁监控端

- **实时监控模式**: 自动调用摄像头,按设定间隔抓取画面进行识别
  - 识别通过: 绿色人脸框,显示姓名和置信度
  - 识别拒绝: 红色人脸框,显示"陌生人"
- **图片模式**: 上传本地图片进行单次识别

### 2. 管理后台

- **人员管理**: 录入/删除人员,上传标准照片自动提取特征
- **通行日志**: 查看历史识别记录
- **系统设置**: 调整识别参数(如抽帧间隔)

## 重要说明

**本项目仅供学习和研究使用**

由于项目将开源,以下敏感数据已被 `.gitignore` 排除在版本控制之外:

- AI 模型文件 (*.onnx, *.pt 等)
- 数据库文件 (*.db) - 包含用户数据
- 用户隐私数据 (头像、抓拍图等)
- 日志文件
- 环境配置文件 (.env)

### 首次启动

**后端会在首次启动时自动完成以下初始化:**

1. **自动下载 AI 模型**: 系统会从以下来源自动下载所需模型
   - ULFD 人脸检测模型 (~1.2MB) - 从 GitHub 下载
   - ArcFace 特征提取模型 (~130MB) - 从 HuggingFace 下载
   
2. **自动创建数据库**: 创建 SQLite 数据库和必要的表结构

3. **初始化目录结构**: 创建存储头像、日志等必要的目录

**如果自动下载失败** (例如网络问题),日志中会显示下载链接,您可以手动下载模型并放置到 `backend/models/` 目录。

## 隐私与安全

- 所有人脸图像和特征数据仅存储在本地
- 不会上传到任何云端服务
- 请妥善保管数据库和用户数据
- 建议在内网环境部署使用

## 开源协议

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request!

## 联系方式

如有问题或建议,欢迎通过 Issue 反馈。

---

**注意**: 使用本系统时,请遵守当地法律法规,尊重用户隐私权。
